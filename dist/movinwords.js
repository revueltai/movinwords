"use strict";module.exports=class Movinwords{constructor(t={}){this._sentences=null,this._words=[],this._started=!1,this._visible="--v",this._events={},this._eventNames=["start","end","wordTransitionStart","wordTransitionEnd","letterTransitionStart","letterTransitionEnd"],this._classNames={base:"mw",word:"mw-w",letter:"mw-l"},this._options={autostart:!0,duration:1e3,delay:100,offset:20,transition:"fadeIn",wordSpacing:null,highlight:{classname:"highlight",tag:"strong",words:[]},events:{},eventsTransitionProperty:"opacity",...t},this._registerEvents(),this._getSentences(),this._options.autostart&&this.start()}_registerEvents(){const t=this._options.events;for(const s in t)t.hasOwnProperty(s)&&this._isAllowedEvent(s)&&this._addEventListener(s,t[s])}_addEventListener(t,s){if("string"!=typeof t||"function"!=typeof s)return!1;void 0===this._events[t]&&(this._events[t]={listeners:[]}),this._events[t].listeners.push(s)}_emitEvent(t,s){if(void 0===this._events[t])return!1;this._events[t].listeners.forEach((t=>{t(s)}))}_isAllowedEvent(t){return this._eventNames.includes(t)}_isEmptyArray(t){if(Array.isArray(t)&&t)return!t.length}_isHighlightedWord(t){const s=this._options.highlight.words;return s&&!this._isEmptyArray(s)&&s.includes(t)}_isLastLetterOfWord(t,s){return t===s-1}_isLastWordOfSentence(t){let s=!1;for(let[e,i]of this._words.entries())t===i&&e+1===this._words.length&&(s=!0);return s}_setCSSVariables(t){t.style.setProperty("--mw-word-spacing",this._getWordSpacing(t)),t.style.setProperty("--mw-duration",`${this._options.duration}ms`),t.style.setProperty("--mw-delay",`${this._options.delay}ms`),t.style.setProperty("--mw-offset",this._options.offset)}_getWordSpacing(t){return this._options.wordSpacing?this._options.wordSpacing:.4*parseInt(window.getComputedStyle(t,null).getPropertyValue("font-size"))}_getWordsArray(t){return this._words=t.innerText.trim().split(" "),this._words}_getLettersArray(t){return[...t.innerText]}_getSentences(){this._sentences=document.querySelectorAll(this._options.el),this._sentences.forEach((t=>{t.classList.add(this._classNames.base),t.classList.add(this._options.transition)}))}_parseSentences(){this._sentences.forEach((t=>{this._setCSSVariables(t),this._createAndAppendWordTags(t),this._createAndAppendLetterTags(t),setTimeout((()=>{t.classList.add(this._visible),delete t.dataset[this._classNames.base]}),100)}))}_appendTags(t,s){t.innerHTML="";for(const e of s)t.appendChild(e)}_createTag(t){const s=document.createElement(t.tag);s.className=t.className,s.innerText=t.text;for(const e in t.vars)s.style.setProperty(`--mw-${e}`,t.vars[e]);return s}_createAndAppendWordTags(t){const s=this._createWordTags(t);this._appendTags(t,s)}_createAndAppendLetterTags(t){t.querySelectorAll(`.${this._classNames.word}`).forEach(((t,s)=>{const e=this._createLetterTags(t,s+1);this._appendTags(t,e)}))}_createWordTags(t){const s=[],e=this._getWordsArray(t);for(const t of e){let e="span",i=this._classNames.word;this._isHighlightedWord(t)&&(i+=` ${this._options.highlight.classname}`,e=this._options.highlight.tag),s.push(this._createTag({tag:e,className:i,text:t}))}return s}_createLetterTags(t,s){const e=[],i=this._getLettersArray(t);for(const[r,n]of i.entries()){const o=this._createTag({tag:"span",className:`${this._classNames.letter}`,text:n,vars:{w:s,l:r}});if(this._isLastLetterOfWord(r,i.length)){const s={...this._options,word:{el:t,text:t.innerText}};o.addEventListener("transitionstart",(t=>{t.propertyName===this._options.eventsTransitionProperty&&this._emitEvent("wordTransitionStart",s)})),o.addEventListener("transitionend",(e=>{e.propertyName===this._options.eventsTransitionProperty&&(this._emitEvent("wordTransitionEnd",s),this._isLastWordOfSentence(t.innerText)&&this._emitEvent("end",this._options))}))}e.push(o)}return e}start(){this._started||(this._started=!0,this._emitEvent("start",this._options),this._parseSentences())}};
