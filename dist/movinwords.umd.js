!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).Movinwords=e()}(this,(function(){"use strict";return class Movinwords{constructor(t={}){this._sentences=null,this._words=[],this._started=!1,this._visible="--v",this._events={},this._eventNames=["start","end","wordTransitionStart","wordTransitionEnd","letterTransitionStart","letterTransitionEnd"],this._classNames={base:"mw",word:"mw-w",letter:"mw-l"},this._options={autostart:!0,duration:1e3,delay:100,offset:20,transition:"fadeIn",wordSpacing:null,highlight:{classname:"highlight",tag:"strong",words:[]},events:{},eventsTransitionProperty:"opacity",...t},this._registerEvents(),this._getSentences(),this._options.autostart&&this.start()}_registerEvents(){const t=this._options.events;for(const e in t)t.hasOwnProperty(e)&&this._isAllowedEvent(e)&&this._addEventListener(e,t[e])}_addEventListener(t,e){if("string"!=typeof t||"function"!=typeof e)return!1;void 0===this._events[t]&&(this._events[t]={listeners:[]}),this._events[t].listeners.push(e)}_emitEvent(t,e){if(void 0===this._events[t])return!1;this._events[t].listeners.forEach((t=>{t(e)}))}_isAllowedEvent(t){return this._eventNames.includes(t)}_isEmptyArray(t){if(Array.isArray(t)&&t)return!t.length}_isHighlightedWord(t){const e=this._options.highlight.words;return e&&!this._isEmptyArray(e)&&e.includes(t)}_isLastLetterOfWord(t,e){return t===e-1}_isLastWordOfSentence(t){let e=!1;for(let[s,i]of this._words.entries())t===i&&s+1===this._words.length&&(e=!0);return e}_setCSSVariables(t){t.style.setProperty("--mw-word-spacing",this._getWordSpacing(t)),t.style.setProperty("--mw-duration",`${this._options.duration}ms`),t.style.setProperty("--mw-delay",`${this._options.delay}ms`),t.style.setProperty("--mw-offset",this._options.offset)}_getWordSpacing(t){return this._options.wordSpacing?this._options.wordSpacing:.4*parseInt(window.getComputedStyle(t,null).getPropertyValue("font-size"))}_getWordsArray(t){return this._words=t.innerText.trim().split(" "),this._words}_getLettersArray(t){return[...t.innerText]}_getSentences(){this._sentences=document.querySelectorAll(this._options.el),this._sentences.forEach((t=>{t.classList.add(this._classNames.base),t.classList.add(this._options.transition)}))}_parseSentences(){this._sentences.forEach((t=>{this._setCSSVariables(t),this._createAndAppendWordTags(t),this._createAndAppendLetterTags(t),setTimeout((()=>{t.classList.add(this._visible),delete t.dataset[this._classNames.base]}),100)}))}_appendTags(t,e){t.innerHTML="";for(const s of e)t.appendChild(s)}_createTag(t){const e=document.createElement(t.tag);e.className=t.className,e.innerText=t.text;for(const s in t.vars)e.style.setProperty(`--mw-${s}`,t.vars[s]);return e}_createAndAppendWordTags(t){const e=this._createWordTags(t);this._appendTags(t,e)}_createAndAppendLetterTags(t){t.querySelectorAll(`.${this._classNames.word}`).forEach(((t,e)=>{const s=this._createLetterTags(t,e+1);this._appendTags(t,s)}))}_createWordTags(t){const e=[],s=this._getWordsArray(t);for(const t of s){let s="span",i=this._classNames.word;this._isHighlightedWord(t)&&(i+=` ${this._options.highlight.classname}`,s=this._options.highlight.tag),e.push(this._createTag({tag:s,className:i,text:t}))}return e}_createLetterTags(t,e){const s=[],i=this._getLettersArray(t);for(const[n,r]of i.entries()){const o=this._createTag({tag:"span",className:`${this._classNames.letter}`,text:r,vars:{w:e,l:n}});if(this._isLastLetterOfWord(n,i.length)){const e={...this._options,word:{el:t,text:t.innerText}};o.addEventListener("transitionstart",(t=>{t.propertyName===this._options.eventsTransitionProperty&&this._emitEvent("wordTransitionStart",e)})),o.addEventListener("transitionend",(s=>{s.propertyName===this._options.eventsTransitionProperty&&(this._emitEvent("wordTransitionEnd",e),this._isLastWordOfSentence(t.innerText)&&this._emitEvent("end",this._options))}))}s.push(o)}return s}start(){this._started||(this._started=!0,this._emitEvent("start",this._options),this._parseSentences())}}}));
