/*
 * movinwords v1.0.3 - Add animation to your words and sentences tags.
 * Copyright (c) 2021 Ignacio Revuelta
 */
!function(t,e){"function"==typeof define&&define.amd?define(["module","exports"],e):"undefined"!=typeof exports?e(module,exports):(e(e={exports:{}},e.exports),t.movinwords=e.exports)}(this,function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var h=function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var r=[],n=!0,s=!1,i=void 0;try{for(var a,o=t[Symbol.iterator]();!(n=(a=o.next()).done)&&(r.push(a.value),!e||r.length!==e);n=!0);}catch(t){s=!0,i=t}finally{try{!n&&o.return&&o.return()}finally{if(s)throw i}}return r}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")},f=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r,n=arguments[e];for(r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t};function n(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var r=(function(t,e,r){return e&&n(t.prototype,e),r&&n(t,r),t}(s,[{key:"_registerEvents",value:function(){var t,e=this._options.events;for(t in e)e.hasOwnProperty(t)&&this._isAllowedEvent(t)&&this._addEventListener(t,e[t])}},{key:"_addEventListener",value:function(t,e){if("string"!=typeof t||"function"!=typeof e)return!1;void 0===this._events[t]&&(this._events[t]={listeners:[]}),this._events[t].listeners.push(e)}},{key:"_emitEvent",value:function(t,e){if(void 0===this._events[t])return!1;this._events[t].listeners.forEach(function(t){t(e)})}},{key:"_isAllowedEvent",value:function(t){return this._eventNames.includes(t)}},{key:"_isEmptyArray",value:function(t){if(Array.isArray(t)&&t)return!t.length}},{key:"_isHighlightedWord",value:function(t){var e=this._options.highlight.words;return e&&!this._isEmptyArray(e)&&e.includes(t)}},{key:"_isLastLetterOfWord",value:function(t,e){return t===e-1}},{key:"_isLastWordOfSentence",value:function(t){var e=!1,r=!0,n=!1,s=void 0;try{for(var i=this._words.entries()[Symbol.iterator]();!(r=(o=i.next()).done);r=!0){var a=h(o.value,2),o=a[0];t===a[1]&&o+1===this._words.length&&(e=!0)}}catch(t){n=!0,s=t}finally{try{!r&&i.return&&i.return()}finally{if(n)throw s}}return e}},{key:"_setCSSVariables",value:function(t){t.style.setProperty("--mw-word-spacing",this._getWordSpacing(t)),t.style.setProperty("--mw-duration",this._options.duration+"ms"),t.style.setProperty("--mw-delay",this._options.delay+"ms"),t.style.setProperty("--mw-offset",this._options.offset)}},{key:"_getWordSpacing",value:function(t){return this._options.wordSpacing||.4*parseInt(window.getComputedStyle(t,null).getPropertyValue("font-size"))}},{key:"_getWordsArray",value:function(t){return this._words=t.innerText.trim().split(" "),this._words}},{key:"_getLettersArray",value:function(t){return[].concat(function(t){if(Array.isArray(t)){for(var e=0,r=Array(t.length);e<t.length;e++)r[e]=t[e];return r}return Array.from(t)}(t.innerText))}},{key:"_getSentences",value:function(){var e=this;this._sentences=document.querySelectorAll(this._options.el),this._sentences.forEach(function(t){t.classList.add(e._classNames.base),t.classList.add(e._options.transition)})}},{key:"_parseSentences",value:function(){var e=this;this._sentences.forEach(function(t){e._setCSSVariables(t),e._createAndAppendWordTags(t),e._createAndAppendLetterTags(t),setTimeout(function(){t.classList.add(e._visible),delete t.dataset[e._classNames.base]},100)})}},{key:"_appendTags",value:function(t,e){var r=!(t.innerHTML=""),n=!1,s=void 0;try{for(var i=e[Symbol.iterator]();!(r=(a=i.next()).done);r=!0){var a=a.value;t.appendChild(a)}}catch(t){n=!0,s=t}finally{try{!r&&i.return&&i.return()}finally{if(n)throw s}}}},{key:"_createTag",value:function(t){var e,r=document.createElement(t.tag);for(e in r.className=t.className,r.innerText=t.text,t.vars)r.style.setProperty("--mw-"+e,t.vars[e]);return r}},{key:"_createAndAppendWordTags",value:function(t){var e=this._createWordTags(t);this._appendTags(t,e)}},{key:"_createAndAppendLetterTags",value:function(t){var r=this;t.querySelectorAll("."+this._classNames.word).forEach(function(t,e){e=r._createLetterTags(t,e+1);r._appendTags(t,e)})}},{key:"_createWordTags",value:function(t){var e=[],r=this._getWordsArray(t),n=!0,s=!1,i=void 0;try{for(var a=r[Symbol.iterator]();!(n=(u=a.next()).done);n=!0){var o=u.value,l="span",u=this._classNames.word;this._isHighlightedWord(o)&&(u+=" "+this._options.highlight.classname,l=this._options.highlight.tag),e.push(this._createTag({tag:l,className:u,text:o}))}}catch(t){s=!0,i=t}finally{try{!n&&a.return&&a.return()}finally{if(s)throw i}}return e}},{key:"_createLetterTags",value:function(r,t){var n=this,e=[],s=this._getLettersArray(r),i=!0,a=!1,o=void 0;try{for(var l=s.entries()[Symbol.iterator]();!(i=(c=l.next()).done);i=!0){var u=h(c.value,2),c=u[0],u=u[1],d=this._createTag({tag:"span",className:""+this._classNames.letter,text:u,vars:{w:t,l:c}});this._isLastLetterOfWord(c,s.length)&&function(){var e=f({},n._options,{word:{el:r,text:r.innerText}});d.addEventListener("transitionstart",function(t){t.propertyName===n._options.eventsTransitionProperty&&n._emitEvent("wordTransitionStart",e)}),d.addEventListener("transitionend",function(t){t.propertyName===n._options.eventsTransitionProperty&&(n._emitEvent("wordTransitionEnd",e),n._isLastWordOfSentence(r.innerText)&&n._emitEvent("end",n._options))})}(),e.push(d)}}catch(t){a=!0,o=t}finally{try{!i&&l.return&&l.return()}finally{if(a)throw o}}return e}},{key:"start",value:function(){this._started||(this._started=!0,this._emitEvent("start",this._options),this._parseSentences())}}]),s);function s(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};!function(t){if(!(t instanceof s))throw new TypeError("Cannot call a class as a function")}(this),this._sentences=null,this._words=[],this._started=!1,this._visible="--v",this._events={},this._eventNames=["start","end","wordTransitionStart","wordTransitionEnd","letterTransitionStart","letterTransitionEnd"],this._classNames={base:"mw",word:"mw-w",letter:"mw-l"},this._options=f({autostart:!0,duration:1e3,delay:0,offset:20,transition:"fadeIn",wordSpacing:null,highlight:{classname:"highlight",tag:"strong",words:[]},events:{},eventsTransitionProperty:"opacity"},t),this._registerEvents(),this._getSentences(),this._options.autostart&&this.start()}e.default=r,t.exports=e.default});